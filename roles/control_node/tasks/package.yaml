- name: System Software
  become: true
  ansible.builtin.dnf:
    name:
      - ansible.builtin.dnf-automatic
      - ansible.builtin.dnf-plugin-system-upgrade
      - rpmconf
      - symlinks
    state: latest
- name: Administration software
  become: true
  ansible.builtin.dnf:
    name:
      - fish
      - git
      - mc
      - nmap
      - tmux
      - toolbox
    state: latest

- name: Add terraform repo
  become: true
  ansible.builtin.yum_repository:
    name: hashicorp
    description: hashicorp
    baseurl: https://rpm.releases.hashicorp.com/fedora/$releasever/$basearch/stable
    gpgcheck: yes
    gpgkey: https://rpm.releases.hashicorp.com/gpg

- name: Install yum-utils
  become: true
  ansible.builtin.yum:
    name: yum-utils
    state: latest

- name: Install terraform
  become: true
  ansible.builtin.yum:
    name: terraform
    state: latest

- name: Encryption software
  become: true
  ansible.builtin.dnf:
    name:
      - age
    state: latest

- name: Get latest sops release
  uri:
    url: https://api.github.com/repos/mozilla/sops/releases/latest
    return_content: true
  register: sops_latest
- name: Install sops
  become: true
  ansible.builtin.dnf:
    name: "{{ sops_latest.json.assets[0].browser_download_url }}"
    state: present
    disable_gpg_check: yes

- name: Get latest chezmoi release
  uri:
    url: https://api.github.com/repos/twpayne/chezmoi/releases/latest
    return_content: true
  register: chezmoi_latest
- name: Install chezmoi
  become: true
  ansible.builtin.dnf:
    name: "{{ chezmoi_latest.json.assets[6].browser_download_url }}"
    state: present
    disable_gpg_check: yes

- name: Dev software
  become: True
  ansible.builtin.dnf:
    name:
      - ShellCheck
      - git
      - golang
    state: latest
- name: Misc software
  become: True
  ansible.builtin.dnf:
    name:
      - compsize
      - curl
      - wget
    state: latest
- name: Upgrade ansible
  pip:
    name:
      - ansible
    state: latest
