FROM docker.io/caddy:2.8.4-builder@sha256:c8f36c045c373e310d7561b97675216a9ccffe21d2d3b4871675c22b37433e65 AS builder

RUN --mount=type=cache,target=/go/pkg,sharing=locked \
    xcaddy build \
    --with github.com/caddy-dns/dynv6

FROM docker.io/caddy:2.8.4-alpine@sha256:443526818b69884bf249bffad2a25a7c81a2971d8a34df692567850e967602ce

COPY --from=builder /usr/bin/caddy /usr/bin/caddy
