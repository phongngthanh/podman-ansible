- name: Librespeed config
  file:
    path: '{{ librespeed_data }}/config'
    state: directory

- name: Librespeed pod
  containers.podman.podman_pod:
    name: librespeed
    network: caddy
    state: '{{ librespeed_state }}'

- name: Librespeed
  containers.podman.podman_container:
    name: librespeed-web
    image: 'ghcr.io/linuxserver/librespeed:{{ librespeed_tag }}'
    pod: librespeed
    # ports:
    # - '80:80'
    env:
      PUID: 'global_puid'
      PGID: 'global_pgid'
      PASSWORD: 'librespeed_password'
    volumes:
      - '/etc/localtime:/etc/localtime:ro'
      - '{{ librespeed_data }}/config:/config'
    # network:
    #   - caddy
    restart_policy: 'on-failure'
    state: '{{ librespeed_state }}'