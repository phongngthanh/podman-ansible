- name: Samba
  # SAMBA_GLOBAL_CONFIG_case_SPACE_sensitive: "yes" # Need this option for case sensitive files. This breaks calibre on windows however. Reference: https://www.oreilly.com/openbook/samba/book/ch05_04.html
  containers.podman.podman_container:
    env:
      ACCOUNT_root: "{{ samba_password }}"
      AVAHI_DISABLE: 1
      GROUP_root: 0
      SAMBA_GLOBAL_CONFIG_case_SPACE_sensitive: "yes"
      SAMBA_VOLUME_CONFIG_disk: "[Disk]; path=/shares/disk; {{ samba_shares_settings }}"
      SAMBA_VOLUME_CONFIG_disks: "[Disks]; path=/shares/disks; {{ samba_shares_settings }}"
      SAMBA_VOLUME_CONFIG_storage: "[Storage]; path=/shares/storage; {{ samba_shares_settings }}"
      UID_root: 0
      WSDD2_DISABLE: 1
    image: docker.io/servercontainers/samba:smbd-only-latest@sha256:419334465e338342e30e214480ba3a03396668168b3a5595d7ec9815aaa2bc43
    name: samba
    network: host
    volumes:
      - "{{ ansible_user_dir }}/disk:/shares/disk"
      - "{{ global_disks_data }}:/shares/disks"
      - "{{ global_storage }}:/shares/storage"
