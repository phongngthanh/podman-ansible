- name: Samba
  # SAMBA_GLOBAL_CONFIG_case_SPACE_sensitive: "yes" # Need this option for case sensitive files. This breaks calibre on windows however. Reference: https://www.oreilly.com/openbook/samba/book/ch05_04.html
  containers.podman.podman_container:
    env:
      ACCOUNT_root: "{{ samba_password }}"
      AVAHI_DISABLE: 1
      GROUP_root: 0
      SAMBA_GLOBAL_CONFIG_case_SPACE_sensitive: "yes"
      SAMBA_VOLUME_CONFIG_disks: |
        [Disks]; path=/shares/disks; valid users = root; guest ok = no; read only = no; browseable = yes;
      SAMBA_VOLUME_CONFIG_storage: |
        [Storage]; path=/shares/storage; valid users = root; guest ok = no; read only = no; browseable = yes;
      UID_root: 0
      WSDD2_DISABLE: 1
    generate_systemd:
      container_prefix: ""
      new: true
      path: "{{ ansible_user_dir }}/.config/systemd/user"
      pod_prefix: ""
      separator: ""
    image: "{{ samba_image }}"
    name: samba
    network: host
    state: "{{ samba_state }}"
    volumes:
      - "{{ global_storage }}:/shares/storage"
      - "{{ global_disks_data }}:/shares/disks"
