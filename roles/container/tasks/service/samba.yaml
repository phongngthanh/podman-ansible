- name: Samba
  # SAMBA_GLOBAL_CONFIG_case_SPACE_sensitive: "yes" # Need this option for case sensitive files. This breaks calibre on windows however. Reference: https://www.oreilly.com/openbook/samba/book/ch05_04.html
  containers.podman.podman_container:
    env:
      ACCOUNT_root: "{{ samba_password }}"
      AVAHI_DISABLE: 1
      GROUP_root: 0
      SAMBA_GLOBAL_CONFIG_case_SPACE_sensitive: "yes"
      SAMBA_VOLUME_CONFIG_disk: "[Disk]; path=/shares/disk; {{ samba_shares_settings }}"
      SAMBA_VOLUME_CONFIG_disks: "[Disks]; path=/shares/disks; {{ samba_shares_settings }}"
      SAMBA_VOLUME_CONFIG_storage: "[Storage]; path=/shares/storage; {{ samba_shares_settings }}"
      UID_root: 0
      WSDD2_DISABLE: 1
    generate_systemd:
      container_prefix: ""
      new: true
      path: "{{ ansible_user_dir }}/.config/systemd/user"
      pod_prefix: ""
      separator: ""
    image: "{{ samba_image }}"
    name: samba
    network: host
    state: "{{ samba_state }}"
    volumes:
      - "{{ ansible_user_dir }}/disk:/shares/disk"
      - "{{ global_disks_data }}:/shares/disks"
      - "{{ global_storage }}:/shares/storage"
