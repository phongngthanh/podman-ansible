- name: Setup config file
  ansible.builtin.import_role:
    name: common
    tasks_from: json_edit.yaml
  vars:
    json_file_path: "{{ renovate_volume_config }}"
    json_edit:
      autodiscover: false
      platform: github
      repositories:
        - zephyros-dev/media-server
      token: "{{ renovate_token }}"

- name: Renovate
  containers.podman.podman_container:
    env:
      LOG_LEVEL: DEBUG
      RENOVATE_CONFIG_FILE: /opt/renovate/config.json
    image: docker.io/renovate/renovate:latest@sha256:81f868c3abbaac6753d8be192b06daa0bd2457d91a1f63103dfa7d74bacf0c80
    name: renovate
    volumes:
      - "{{ renovate_volume_config }}:/opt/renovate/config.json:U,z"
      - "{{ renovate_volume_data }}:/tmp/renovate:U,z"
