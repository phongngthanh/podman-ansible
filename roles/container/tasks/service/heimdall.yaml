# - name: Heimdall config
#   file:
#     path: '{{ heimdall_data }}/config'
#     state: directory

- name: Heimdall config volume
  containers.podman.podman_volume:
    name: '{{ heimdall_data_config }}'
    state: present

- name: Heimdall pod
  containers.podman.podman_pod:
    name: heimdall
    network: caddy
    state: '{{ heimdall_state }}'
            
- name: Heimdall
  containers.podman.podman_container:
    name: heimdall-web
    image: 'ghcr.io/linuxserver/heimdall:{{ heimdall_tag }}'
    # user: '1000:1000'
    # env:
    #   PUID: '{{ global_puid }}'
    #   PGID: '{{ global_pgid }}'
    volumes:
      - '/etc/localtime:/etc/localtime:ro'
      - '{{ heimdall_data_config }}:/config'
    pod: heimdall
    # ports:
    #   - 80
    #   - 443
    restart_policy: 'on-failure'
    state: '{{ heimdall_state }}'