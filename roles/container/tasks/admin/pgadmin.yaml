- name: Pgadmin data
  file:
    path: '{{ pgadmin_data }}/pgadmin'
    state: directory

- name: pgadmin pod
  containers.podman.podman_pod:
    name: pgadmin
    network: caddy
    state: '{{ pgadmin_state }}'
    
- name: Pgadmin
  containers.podman.podman_container:
    name: pgadmin-web
    image: 'dpage/pgadmin4:{{ pgadmin_tag }}'
    env:
      PGADMIN_DEFAULT_EMAIL: '{{ pgadmin_email }}'
      PGADMIN_DEFAULT_PASSWORD: '{{ pgadmin_password }}'
    # ports:
    #   - '80'
    pod: pgadmin
    volumes:
      - '/etc/localtime:/etc/localtime:ro,z'
      - '{{ pgadmin_data }}/pgadmin:/var/lib/pgadmin:U,z'
    network: caddy
    restart_policy: 'on-failure:3'
    state: '{{ pgadmin_state }}'