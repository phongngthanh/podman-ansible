- name: "Check if {{ service_name }} systemd file exists"
  ansible.builtin.stat:
    path: "~/.config/systemd/user/service-{{ service_name }}.service"
  register: systemd_state

- name: "Stop {{ service_name }} systemd service"
  ansible.builtin.systemd:
    daemon_reload: yes
    name: service-{{ service_name }}
    scope: user
    state: stopped
  when: systemd_state.stat.exists
