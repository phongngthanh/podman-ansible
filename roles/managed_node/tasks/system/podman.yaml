- name: Podman
  become: True
  dnf:
    name:
      - podman-docker
      - slirp4netns
    state: latest

- name: Podman testing repo
  become: True
  dnf:
    name:
      - podman
    # enablerepo: updates-testing
    state: latest

- name: Enable podman socket
  ansible.builtin.systemd:
    daemon_reload: yes
    enabled: yes
    name: podman.socket
    scope: user
    state: started

- name: Create container config folder
  file:
    path: "~/.config/containers"
    state: directory

- name: Change podman registries configuration
  copy:
    dest: "~/.config/containers/registries.conf"
    src: "podman/registries.conf"

- name: Setup privileged ports
  sysctl:
    name: net.ipv4.ip_unprivileged_port_start
    sysctl_set: yes
    value: "80"
  become: yes
